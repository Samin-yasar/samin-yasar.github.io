<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>My Reading Journey</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=DM+Sans:wght@400;500;600&display=swap" rel="stylesheet" />
<style>
  :root {
    --clr-bg: #f5f0eb;
    --clr-card: #fffdf9;
    --clr-accent: #4f46e5;
    --clr-accent-light: #eef0ff;
    --clr-text: #2d2b27;
    --clr-text-muted: #7a7570;
    --clr-border: #e8e3dc;
    --clr-reading: #4f46e5;
    --clr-completed: #16a34a;
    --clr-wishlist: #9333ea;
    --clr-dropped: #dc2626;
    --clr-hold: #ca8a04;
    --shadow: 0 2px 12px rgba(0,0,0,0.06);
    --shadow-hover: 0 6px 24px rgba(0,0,0,0.12);
    --radius: 14px;
  }

  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

  body {
    font-family: 'DM Sans', sans-serif;
    background: var(--clr-bg);
    color: var(--clr-text);
    min-height: 100vh;
    padding: 40px 20px 60px;
    -webkit-font-smoothing: antialiased;
  }

  .wrapper { max-width: 1140px; margin: 0 auto; }

  /* â”€â”€ Header â”€â”€ */
  .header { text-align: center; margin-bottom: 44px; }
  .header-icon-row { display: flex; align-items: center; justify-content: center; gap: 12px; margin-bottom: 6px; }
  .header-icon { width: 40px; height: 40px; color: var(--clr-accent); }
  .header h1 {
    font-family: 'Playfair Display', serif;
    font-size: clamp(2rem, 5vw, 3rem);
    font-weight: 700;
    letter-spacing: -0.5px;
  }
  .header p { color: var(--clr-text-muted); font-size: 1.05rem; margin-top: 4px; }

  /* â”€â”€ Cards shared â”€â”€ */
  .card {
    background: var(--clr-card);
    border-radius: var(--radius);
    box-shadow: var(--shadow);
    border: 1px solid var(--clr-border);
  }

  /* â”€â”€ Stats Bar â”€â”€ */
  .stats-bar {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
    gap: 12px;
    margin-bottom: 32px;
  }
  .stat-btn {
    padding: 18px 10px;
    border-radius: var(--radius);
    border: 1px solid var(--clr-border);
    background: var(--clr-card);
    box-shadow: var(--shadow);
    cursor: pointer;
    text-align: center;
    transition: transform .2s, box-shadow .2s, background .2s, color .2s;
  }
  .stat-btn:hover { box-shadow: var(--shadow-hover); transform: translateY(-2px); }
  .stat-btn.active {
    background: var(--clr-accent);
    color: #fff;
    border-color: var(--clr-accent);
    transform: scale(1.04);
  }
  .stat-btn .num { font-size: 1.6rem; font-weight: 600; }
  .stat-btn .label { font-size: 0.78rem; color: var(--clr-text-muted); margin-top: 2px; }
  .stat-btn.active .label { color: rgba(255,255,255,.75); }

  /* â”€â”€ Reading Time Panel â”€â”€ */
  .time-panel { padding: 28px; margin-bottom: 32px; }
  .time-panel-head {
    display: flex; flex-wrap: wrap;
    justify-content: space-between; align-items: center;
    gap: 14px; margin-bottom: 20px;
  }
  .time-panel-head h2 {
    font-family: 'Playfair Display', serif;
    font-size: 1.35rem; font-weight: 600;
    display: flex; align-items: center; gap: 8px;
  }
  .time-panel-head h2 svg { color: var(--clr-accent); width: 20px; height: 20px; }
  .time-pills { display: flex; gap: 8px; flex-wrap: wrap; }
  .pill {
    padding: 5px 14px; border-radius: 999px;
    border: 1px solid var(--clr-border);
    background: #fff; font-size: 0.82rem; font-weight: 500;
    cursor: pointer; transition: all .2s; color: var(--clr-text-muted);
  }
  .pill:hover { border-color: var(--clr-accent); color: var(--clr-accent); }
  .pill.active { background: var(--clr-accent); color: #fff; border-color: var(--clr-accent); }

  .chart-wrap { width: 100%; height: 180px; position: relative; }
  canvas#chart { width: 100%; height: 100%; display: block; }

  .time-summary { text-align: center; margin-top: 16px; font-size: 0.92rem; color: var(--clr-text-muted); }
  .time-summary strong { color: var(--clr-accent); }

  /* â”€â”€ Books Grid â”€â”€ */
  .books-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
    gap: 22px;
  }

  .book-card {
    overflow: hidden;
    transition: box-shadow .25s, transform .25s;
  }
  .book-card:hover { box-shadow: var(--shadow-hover); transform: translateY(-3px); }

  .book-card .color-bar { height: 5px; }

  .book-card .body { padding: 22px; }
  .book-card h3 { font-family: 'Playfair Display', serif; font-size: 1.18rem; font-weight: 600; margin-bottom: 2px; }
  .book-card .author { color: var(--clr-text-muted); font-style: italic; font-size: 0.9rem; margin-bottom: 12px; }

  .badge {
    display: inline-block;
    padding: 4px 12px; border-radius: 999px;
    font-size: 0.78rem; font-weight: 500;
    color: #fff; margin-bottom: 12px;
  }

  .stars { display: flex; align-items: center; gap: 3px; margin-bottom: 10px; }
  .star { width: 16px; height: 16px; }
  .stars-label { font-size: 0.8rem; color: var(--clr-text-muted); margin-left: 4px; }

  .meta-row { font-size: 0.82rem; color: var(--clr-text-muted); margin-bottom: 6px; display: flex; align-items: center; gap: 6px; }
  .meta-row svg { width: 14px; height: 14px; flex-shrink: 0; }

  .notes-box {
    margin-top: 14px;
    padding: 12px 14px;
    background: var(--clr-accent-light);
    border-left: 3px solid var(--clr-accent);
    border-radius: 0 8px 8px 0;
  }
  .notes-box .notes-label { font-size: 0.72rem; font-weight: 600; color: var(--clr-accent); text-transform: uppercase; letter-spacing: .5px; margin-bottom: 3px; }
  .notes-box p { font-size: 0.85rem; font-style: italic; color: var(--clr-text); }

  /* â”€â”€ Empty State â”€â”€ */
  .empty-state {
    text-align: center; padding: 60px 20px;
    background: var(--clr-card); border-radius: var(--radius);
    box-shadow: var(--shadow); border: 1px solid var(--clr-border);
  }
  .empty-state svg { width: 56px; height: 56px; color: #ccc; margin-bottom: 12px; }
  .empty-state p { color: var(--clr-text-muted); font-size: 1.05rem; }

  /* â”€â”€ Footer â”€â”€ */
  .footer { text-align: center; margin-top: 48px; color: var(--clr-text-muted); font-size: 0.82rem; }

  /* â”€â”€ Loader â”€â”€ */
  .loader {
    min-height: 60vh; display: flex;
    align-items: center; justify-content: center;
    font-size: 1.2rem; color: var(--clr-text-muted);
  }

  /* â”€â”€ Responsive â”€â”€ */
  @media (max-width: 520px) {
    .books-grid { grid-template-columns: 1fr; }
    .stats-bar { grid-template-columns: repeat(3, 1fr); }
  }
</style>
</head>
<body>

<div class="wrapper" id="app">
  <div class="loader" id="loader">Loading booksâ€¦</div>
</div>

<!-- â•â•â• SVG Icons (reusable) â•â•â• -->
<svg style="display:none">
  <defs>
    <symbol id="icon-book" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-1H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-1h7z"/>
    </symbol>
    <symbol id="icon-clock" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/>
    </symbol>
    <symbol id="icon-star-filled" viewBox="0 0 24 24" fill="#facc15" stroke="#facc15" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/>
    </symbol>
    <symbol id="icon-star-empty" viewBox="0 0 24 24" fill="none" stroke="#d1d5db" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/>
    </symbol>
  </defs>
</svg>

<script>
// â”€â”€â”€ Data & Config â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const STATUSES = [
  { id: 'reading',   label: 'Reading',   color: '#4f46e5' },
  { id: 'completed', label: 'Completed', color: '#16a34a' },
  { id: 'wishlist',  label: 'Wishlist',  color: '#9333ea' },
  { id: 'dropped',   label: 'Dropped',   color: '#dc2626' },
  { id: 'hold',      label: 'On Hold',   color: '#ca8a04' }
];

let books        = [];
let activeStatus = 'all';
let timeView     = 'month';

// â”€â”€â”€ Fetch Books â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function loadBooks() {
  try {
    const res  = await fetch('booklist.json');
    const data = await res.json();
    books = data.books || [];
  } catch (e) {
    console.warn('booklist.json not found or invalid');
    books = [];
  }
  render();
}

// â”€â”€â”€ Stats helpers â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function getReadingStats() {
  const now   = Date.now();
  const DAY   = 86400000;
  const stats = { day: 0, month: 0, year: 0, allTime: 0 };

  books.forEach(b => {
    const t = b.readingTime || 0;
    stats.allTime += t;
    if (b.endDate) {
      const end = new Date(b.endDate).getTime();
      if (end >= now - DAY)       stats.day   += t;
      if (end >= now - 30 * DAY)  stats.month += t;
      if (end >= now - 365 * DAY) stats.year  += t;
    }
  });
  return stats;
}

function avgRating() {
  const rated = books.filter(b => b.rating > 0);
  return rated.length ? (rated.reduce((s, b) => s + b.rating, 0) / rated.length).toFixed(1) : 0;
}

// â”€â”€â”€ Chart (vanilla canvas) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function drawChart() {
  const canvas = document.getElementById('chart');
  if (!canvas) return;
  const ctx    = canvas.getContext('2d');
  const dpr    = window.devicePixelRatio || 1;

  // size
  const rect   = canvas.parentElement.getBoundingClientRect();
  const W      = rect.width;
  const H      = rect.height || 180;
  canvas.width  = W * dpr;
  canvas.height = H * dpr;
  canvas.style.width  = W  + 'px';
  canvas.style.height = H  + 'px';
  ctx.scale(dpr, dpr);

  // clear
  ctx.clearRect(0, 0, W, H);

  // data
  const stats = getReadingStats();
  const labels = { day:'Today', month:'This Month', year:'This Year', alltime:'All Time' };
  const values = { day: stats.day, month: stats.month, year: stats.year, alltime: stats.allTime };

  const keys   = ['day','month','year','alltime'];
  const pad    = { top: 24, right: 28, bottom: 36, left: 48 };
  const chartW = W - pad.left - pad.right;
  const chartH = H - pad.top  - pad.bottom;
  const maxVal = Math.max(...keys.map(k => values[k]), 1);

  // grid lines + y labels
  ctx.strokeStyle = '#e8e3dc';
  ctx.lineWidth   = 1;
  ctx.fillStyle   = '#7a7570';
  ctx.font        = '11px "DM Sans", sans-serif';
  ctx.textAlign   = 'right';
  const gridCount = 4;
  for (let i = 0; i <= gridCount; i++) {
    const y = pad.top + chartH - (chartH * i / gridCount);
    ctx.beginPath();
    ctx.moveTo(pad.left, y);
    ctx.lineTo(W - pad.right, y);
    ctx.stroke();
    const val = (maxVal * i / gridCount).toFixed(0);
    ctx.fillText(val + 'h', pad.left - 8, y + 4);
  }

  // bars
  const barW    = Math.min(chartW / keys.length * 0.55, 80);
  const gapW    = (chartW - barW * keys.length) / (keys.length + 1);

  keys.forEach((k, i) => {
    const barH  = (values[k] / maxVal) * chartH;
    const x     = pad.left + gapW * (i + 1) + barW * i;
    const y     = pad.top  + chartH - barH;

    // bar colour: active = accent, rest = light
    const isActive = (k === timeView);
    ctx.fillStyle  = isActive ? '#4f46e5' : '#c7c3f7';
    ctx.beginPath();
    // rounded top
    const r = 6;
    ctx.moveTo(x + r, y);
    ctx.lineTo(x + barW - r, y);
    ctx.quadraticCurveTo(x + barW, y, x + barW, y + r);
    ctx.lineTo(x + barW, y + barH);
    ctx.lineTo(x, y + barH);
    ctx.lineTo(x, y + r);
    ctx.quadraticCurveTo(x, y, x + r, y);
    ctx.closePath();
    ctx.fill();

    // value label above bar
    ctx.fillStyle = '#2d2b27';
    ctx.font      = '600 12px "DM Sans", sans-serif';
    ctx.textAlign = 'center';
    ctx.fillText(values[k] + 'h', x + barW / 2, y - 6);

    // x label
    ctx.fillStyle = isActive ? '#4f46e5' : '#7a7570';
    ctx.font      = (isActive ? '600 ' : '400 ') + '11px "DM Sans", sans-serif';
    ctx.fillText(labels[k], x + barW / 2, pad.top + chartH + 22);
  });
}

// â”€â”€â”€ Icon helpers â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const iconBook  = '<svg class="header-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-1H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-1h7z"/></svg>';
const iconClock = (sz=20) => `<svg width="${sz}" height="${sz}" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>`;
const iconCalendar = (sz=14) => `<svg width="${sz}" height="${sz}" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>`;

function starHTML(rating) {
  let html = '<div class="stars">';
  for (let i = 1; i <= 5; i++)
    html += `<svg class="star" viewBox="0 0 24 24"><use href="#icon-star-${i <= rating ? 'filled' : 'empty'}"/></svg>`;
  html += `<span class="stars-label">(${rating}/5)</span></div>`;
  return html;
}

// â”€â”€â”€ Main Render â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function render() {
  const app = document.getElementById('app');

  // counts
  const counts = { all: books.length };
  STATUSES.forEach(s => { counts[s.id] = books.filter(b => b.status === s.id).length; });

  const filtered = activeStatus === 'all' ? books : books.filter(b => b.status === activeStatus);
  const stats    = getReadingStats();
  const avg      = avgRating();

  app.innerHTML = `
  <!-- Header -->
  <div class="header">
    <div class="header-icon-row">
      ${iconBook}
      <h1>My Reading Journey</h1>
    </div>
    <p>Explore my personal library and reading habits</p>
  </div>

  <!-- Reading Time Panel -->
  <div class="card time-panel">
    <div class="time-panel-head">
      <h2>${iconClock(20)} Reading Time Statistics</h2>
      <div class="time-pills" id="pills">
        ${['day','month','year','alltime'].map(v =>
          `<button class="pill ${timeView===v?'active':''}" data-view="${v}">${v==='alltime'?'All Time':v.charAt(0).toUpperCase()+v.slice(1)}</button>`
        ).join('')}
      </div>
    </div>
    <div class="chart-wrap"><canvas id="chart"></canvas></div>
    <div class="time-summary">
      Total reading time: <strong>${stats.allTime} hours</strong>
      ${avg > 0 ? `&nbsp;Â·&nbsp; Average rating: <strong>${avg} / 5</strong>` : ''}
    </div>
  </div>

  <!-- Status Filter Buttons -->
  <div class="stats-bar" id="statBar">
    <button class="stat-btn ${activeStatus==='all'?'active':''}" data-status="all">
      <div class="num">${counts.all}</div><div class="label">All Books</div>
    </button>
    ${STATUSES.map(s => `
      <button class="stat-btn ${activeStatus===s.id?'active':''}" data-status="${s.id}" style="${activeStatus===s.id?'background:'+s.color+';border-color:'+s.color:''}">
        <div class="num">${counts[s.id]}</div><div class="label">${s.label}</div>
      </button>
    `).join('')}
  </div>

  <!-- Books Grid -->
  ${filtered.length === 0 ? `
    <div class="empty-state">
      ${iconBook}
      <p>No books in this category yet.</p>
    </div>
  ` : `
    <div class="books-grid" id="grid">
      ${filtered.map(b => {
        const st = STATUSES.find(s => s.id === b.status) || STATUSES[0];
        return `
        <div class="book-card card">
          <div class="color-bar" style="background:${st.color}"></div>
          <div class="body">
            <h3>${b.title}</h3>
            ${b.author ? `<p class="author">by ${b.author}</p>` : ''}
            <span class="badge" style="background:${st.color}">${st.label}</span><br/>
            ${b.rating > 0 ? starHTML(b.rating) : ''}
            ${b.readingTime > 0 ? `<div class="meta-row">${iconClock(14)}<span>${b.readingTime} hours</span></div>` : ''}
            ${b.startDate ? `<div class="meta-row">${iconCalendar()}<span>Started: ${new Date(b.startDate).toLocaleDateString()}</span></div>` : ''}
            ${b.endDate   ? `<div class="meta-row">${iconCalendar()}<span>Finished: ${new Date(b.endDate).toLocaleDateString()}</span></div>` : ''}
            ${b.notes ? `<div class="notes-box"><div class="notes-label">Personal Review</div><p>"${b.notes}"</p></div>` : ''}
          </div>
        </div>`;
      }).join('')}
    </div>
  `}

  <!-- Footer -->
  <div class="footer">ðŸ“š Personal book collection Â· Last updated: ${new Date().toLocaleDateString()}</div>
  `;

  // Attach events
  document.getElementById('pills').addEventListener('click', e => {
    if (e.target.classList.contains('pill')) {
      timeView = e.target.dataset.view;
      render();
    }
  });

  document.getElementById('statBar').addEventListener('click', e => {
    const btn = e.target.closest('.stat-btn');
    if (btn) { activeStatus = btn.dataset.status; render(); }
  });

  // draw chart after DOM is ready
  requestAnimationFrame(drawChart);
}

// Redraw chart on resize
window.addEventListener('resize', drawChart);

// â”€â”€ Boot â”€â”€
loadBooks();
</script>
</body>
</html>
